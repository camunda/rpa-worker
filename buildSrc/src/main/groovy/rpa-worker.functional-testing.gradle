
sourceSets {
	functionalTest {
		compileClasspath += sourceSets.main.output
		runtimeClasspath += sourceSets.main.output
	}
}

configurations {
	functionalTestImplementation.extendsFrom testImplementation
	functionalTestImplementation.extendsFrom compileOnly
	functionalTestRuntimeOnly.extendsFrom testRuntimeOnly
}

tasks.register('functionalTest', Test) {
	description = 'Runs functional tests.'
	group = 'verification'

	testClassesDirs = sourceSets.functionalTest.output.classesDirs
	classpath = sourceSets.functionalTest.runtimeClasspath
	shouldRunAfter test
}

check.dependsOn functionalTest

idea {
	module {
		testSources.from(sourceSets.functionalTest.java.srcDirs)
		testSources.from(sourceSets.functionalTest.groovy.srcDirs)
	}
}